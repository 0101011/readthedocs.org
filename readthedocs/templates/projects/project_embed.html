{% extends "projects/base_project.html" %}
{% load i18n %}
{% load privacy_tags %}
{% load core_tags highlight  %}
{% load static %}

{% block title %}
Tools
{% endblock title %}

{% block project_editing %}
  {% with tools_active="active" %}
    {% include "core/project_bar.html" %}
  {% endwith %}
{% endblock %}


{% block extra_scripts %}
  <script type="text/javascript" src="{% static 'projects/js/tools.js' %}"></script>
  <script type="text/javascript">
$(document).ready(function () {
    tools.init_embed({
        api_host: 'http://127.0.0.1:8888'
    })
});
  </script>
{% endblock %}


{% block content %}
  <div class="navigable">
    <ul>
      <li class="active">
        <a href="{% url 'project_embed' project.slug %}">Embed</a>
      </li>
      <li>
        <a href="{% url 'project_analytics' project.slug %}">Analytics</a>
      </li>
    </ul>

    <div id='tool-embed'>

      <div id="help_container">
        <a class="quiet" href="javascript:showHelp()">(Help)</a>
        <div id="id_help" class="help" style="display: none;"></div>
      </div>

      <h1>Embed API</h1>

      <p class="help_text">
        {% trans "Embed content into any site on the internet dynamically." %}
      </p>

      <h3>{% trans "File" %}</h3>
      <select id="id_file" name="file" data-bind="value: file">
        <option value="">Select a File</option>
        {% for file in files %}
          <option value="{{ file.path|cut:".html" }}">{{ file.path }}</option>
        {% endfor %}
      </select>

      <div data-bind="visible: has_sections">
        <h3>Section</h3>
        <select id="id_section" data-bind="enable: has_sections, options: sections, value: section, optionsCaption: 'Choose a Section', optionsText: 'title', optionsValue: 'id'"></select>
      </div>

      <p data-bind="text: help, visible: help != null"></p>

      <div data-bind="visible: has_section">
        <h3>API</h3>
        <div id="id_url" data-bind="text: api_example"></div>
      </div>

      <div data-bind="visible: has_response">
        <h3>Results</h3>

        <h4>Rendered</h4>
        <div data-bind="html: response"></div>
        <iframe id='results' width="100%" height="400px">
          <html>
          </html>
        </iframe>

        <h4>Raw</h4>
        <pre id="results_raw" data-bind="text: response"></pre>
      </div>

    </div>
  </div>
{% endblock %}
